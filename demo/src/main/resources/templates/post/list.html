<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>ê²Œì‹œê¸€ ëª©ë¡</title>
    <!--í˜ì´ì§•(UI)-->
    <style>
        .pagination {
            margin-top: 20px; <!-- í˜ì´ì§€ ë²„íŠ¼ ì˜ì—­ì„ ìœ„ì™€ ë–¨ì–´ëœ¨ë¦¼ -->
        }
        .pagination a, .pagination span {
            display: inline-block;   <!-- ë§í¬ì™€ í…ìŠ¤íŠ¸ë¥¼ ì˜†ìœ¼ë¡œ ë‚˜ë€íˆ ë°°ì¹˜-->
            padding: 5px 10px;       <!-- ì•ˆìª½ ì—¬ë°±: ë²„íŠ¼ í¬ê¸° -->
            margin: 2px;             <!-- ë°”ê¹¥ ì—¬ë°±: ë²„íŠ¼ ê°„ ê°„ê²© -->
            border: 1px solid #ccc;  <!-- í…Œë‘ë¦¬: íšŒìƒ‰ -->
            border-radius: 4px;      <!-- ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ-->
            text-decoration: none;   <!-- ë°‘ì¤„ ì œê±°-->
            color: #333;             <!-- ê¸€ììƒ‰: ì§„í•œ íšŒìƒ‰ -->
        }
        .pagination .current {
            font-weight: bold; <!-- í˜„ì¬ í˜ì´ì§€ ê¸€ì”¨ êµµê²Œ-->
            background: #eee;  <!-- í˜„ì¬ í˜ì´ì§€ ë°°ê²½ì„ ì—°íšŒìƒ‰ìœ¼ë¡œ -->
        }
    </style>
</head>
<body>
<!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
<div th:replace="fragments/nav :: navbar"></div>

<h1>ğŸ“‹ ê²Œì‹œê¸€ ëª©ë¡</h1>

<!--  ê²€ìƒ‰ í¼ -->
<form th:action="@{/posts/search}" method="get">
    <!-- ê²€ìƒ‰ ê¸°ì¤€ ì„ íƒ -->
    <select name="type">
        <!-- ì„ íƒëœ ê²€ìƒ‰ ê¸°ì¤€ ìœ ì§€ -->
        <option th:value="titleContent" th:selected="${selectedType} == 'titleContent'">ì œëª©+ë‚´ìš©</option>
        <option th:value="userId"       th:selected="${selectedType} == 'userId'">ì‘ì„±ì ID</option>
        <option th:value="postId"       th:selected="${selectedType} == 'postId'">ê¸€ë²ˆí˜¸</option>
    </select>

    <!-- ê²€ìƒ‰ì–´ ì…ë ¥ (ê²€ìƒ‰ í›„ì—ë„ ê°’ ìœ ì§€) -->
    <input type="text" name="keyword" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" th:value="${keyword}">
    <button type="submit">ê²€ìƒ‰</button>
</form>

<!-- ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ > userId/postIdê²€ìƒ‰ì— ìˆ«ìê°€ ì•„ë‹ê²½ìš°!-->
<p th:if="${message}"
   th:text="${message}"
   style="color:red; font-weight:bold;"></p>
<!--ã…¡modelì— message ê°’ì´ ìˆìœ¼ë©´ ì¶œë ¥!-->
<hr>

<!-- ê²Œì‹œê¸€ì´ ì—†ì„ ë•Œ -->
<p th:if="${posts.isEmpty()}">ì‘ì„±ëœ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>

<!-- ê²Œì‹œê¸€ ëª©ë¡ í…Œì´ë¸” -->
<table border="1" th:if="${!posts.isEmpty()}">
    <thead>
    <tr>
        <th>ë²ˆí˜¸(ID)</th>
        <th>ì œëª©</th>
        <th>ì‘ì„±ì</th>
    </tr>
    </thead>
    <tbody>
    <!-- ë°˜ë³µë¬¸ìœ¼ë¡œ posts ì¶œë ¥ -->
    <!--th:each="post : ${posts}" : posts ì»¬ë ‰ì…˜ì„ í•˜ë‚˜ì”© êº¼ë‚´ postë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©-->
    <tr th:each="post : ${posts}">
        <!--ê²Œì‹œê¸€ ID-->
        <td th:text="${post.id}"></td>
        <!--ê²Œì‹œê¸€ ì œëª© ëˆ„ë¥´ë©´ í•´ë‹¹ ê²Œì‹œê¸€ ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™í•˜ê¸°-->
        <td>
            <a th:href="@{'/posts/' + ${post.id}}" th:text="${post.title}"></a>
        </td>
        <!--ì‘ì„±ì ë‹‰ë„¤ì„ (Post >> User >> nickname)-->
        <td th:text="${post.user.nickname}"></td>
    </tr>
    </tbody>
</table>
<!-- í˜ì´ì§• UI -->
<!-- ì „ì²´ í˜ì´ì§€ ìˆ˜ê°€ 1ë³´ë‹¤ í´ ë•Œë§Œ í‘œì‹œ -->
<div class="pagination" th:if="${totalPages > 1}">
    <!--  ì´ì „ ë²„íŠ¼
    th:if="${currentPage > 0}" í˜„ì¬ í˜ì´ì§€ê°€ 0ë³´ë‹¤ í´ ë•Œë§Œ <a>íƒœê·¸ë¥¼ ë³´ì—¬ì£¼ê² ë‹¤ëŠ” ì²˜ë¦¬.
    ì¦‰ ì²«í˜ì´ì§€ì—ì„  ì•ˆë³´ì´ëŠ”ê²Œ ì •ìƒ
    th:href="@{/posts(page=${currentPage - 1}, size=10)}"
     /postsìš”ì²­ ë³´ë‚¼ ë•Œ pageì™€ size íŒŒë¼ë¯¸í„°ë¥¼ ë¶™ì—¬ì¤Œ.í˜„ì¬ í˜ì´ì§€ì—ì„œ 1ì„ ë¹¼ì„œ ì´ì „ í˜ì´ì§€ ë²ˆí˜¸ë¥¼ ë§Œë“ ë‹¤.
     size = 10 : í•œ í˜ì´ì§€ì— ê¸€ì„ 10ê°œì”© ë³´ì—¬ì£¼ê² ë‹¤.
     -->
    <a th:if="${currentPage > 0}"
       th:href="@{/posts(page=${currentPage - 1}, size=10)}">ì´ì „</a>

    <!--  í˜ì´ì§€ ë²ˆí˜¸ -->
    <!-- #numbers.sequence(0, totalPages-1) â†’ 0ë¶€í„° totalPages-1ê¹Œì§€ ìˆ«ìë°°ì—´ ìƒì„±
    í† íƒˆí˜ì´ì§€ê°€ 4ë¼ë©´ [0,1,2,3] >>
    th:each="i:..." : ê° ìˆ«ìë¥¼ ië¼ëŠ” ë³€ìˆ˜ì— ë‹´ì•„ ë°˜ë³µë¬¸ëŒë¦¬ê¸°-->
    <span th:each="i : ${#numbers.sequence(0, totalPages-1)}">
        <!-- ì¡°ê±´ë¬¸ í˜„ì¬ í˜ì´ì§€ê°€ ì•„ë‹ˆë©´ a íƒœê·¸ë¡œ í‘œì‹œ -->
        <a th:if="${i != currentPage}"
           th:href="@{/posts(page=${i}, size=10)}"
           th:text="${i + 1}"></a>
        <!-- ì¡°ê±´ë¬¸ í˜„ì¬ í˜ì´ì§€ëŠ” span.current ë¡œ ê°•ì¡° -->
        <span th:if="${i == currentPage}"
              th:text="${i + 1}"
              class="current"></span>
    </span>

    <!--  ë‹¤ìŒ ë²„íŠ¼ -->
    <!--  í˜„ì¬ í˜ì´ì§€ ë²ˆí˜¸ + 1ì´ ì „ì²´ í˜ì´ì§€ ìˆ˜ë³´ë‹¤ ì‘ì„ ë•Œë§Œ ë³´ì´ê²Œ í•¨ -->
    <a th:if="${currentPage + 1 < totalPages}"
       th:href="@{/posts(page=${currentPage + 1}, size=10)}">ë‹¤ìŒ</a>
</div>


<br>
<a th:href="@{/posts/new}">âœ ê¸€ì“°ê¸°</a>
</body>
</html>
